/* ==========================================================================
   COMPONENTS / #DETAILS
   ========================================================================== */

/**
 * Details component.
 *
 * Original code taken from GDS (Government Digital Service)
 * https://github.com/alphagov/govuk-frontend
 *
 * 1. Style the summary to look like a link...
 * 2. Make the focus outline shrink-wrap the text content of the summary
 * 3. Absolutely position the marker against this element
 * 3. Allow for absolutely positioned marker and align with disclosed text
 * 4. Only underline the text, not the arrow
 * 5. Remove the default details marker so we can style our own consistently and
 *    ensure it displays in Firefox
 */

.nhsuk-details {
  @include nhsuk-text-color;
  @include nhsuk-responsive-margin(6, 'bottom');
  @include nhsuk-typography-responsive(19);
  display: block;
}

.nhsuk-details__summary {
  color: $color_nhsuk-blue; /* [1] */
  cursor: pointer;
  display: inline-block; /* [2] */
  padding-left: nhsuk-spacing(4);
  position: relative; /* [3] */

  @include nhsuk-link-style-hover();
  @include nhsuk-link-style-focus();

  &:before {
    bottom: 0;
    content: '';
    left: 0;
    margin: auto;
    position: absolute;
    top: 0;

    @include govuk-shape-arrow($direction: right, $base: 14px);

    .nhsuk-details[open] > & { // sass-lint:disable-line force-attribute-nesting
      @include govuk-shape-arrow($direction: down, $base: 14px);
    }
  }

  &:focus {
    box-shadow: 0 0 0 $nhsuk-box-details $nhsuk-link-focus-background-color;
    color: $nhsuk-link-focus-color;

    .nhsuk-details__summary-text {
      color: $nhsuk-link-focus-color;
    }
  }

  &:hover {
    background-color: $nhsuk-link-hover-background-color;
    box-shadow: 0 0 0 $nhsuk-box-details $nhsuk-link-hover-background-color;

    .nhsuk-details__summary-text {
      color: $nhsuk-link-hover-color;
      text-decoration: none;
    }

  }

}

.nhsuk-details__summary-text {
  text-decoration: underline; /* [4] */
}

.nhsuk-details__summary::-webkit-details-marker { // sass-lint:disable-line force-pseudo-nesting
  display: none; /* [5] */
}

.nhsuk-details__text {
  border-left: nhsuk-spacing(1) solid $color_nhsuk-grey-4;
  margin-top: nhsuk-spacing(2);
  padding: nhsuk-spacing(3);
  padding-left: nhsuk-spacing(4);
  @include top-and-bottom();

  p {
    margin-bottom: nhsuk-spacing(4);
    margin-top: 0;
  }

}

/**
 * Expander variation.
 *
 * 1. !important used because the icon is populated
 *    by the JavaScript polyfill
 * 2. Remove the default hover, focus and active
 *    styles for this component.
 * 3. -2px left margin to align the icon to the content.
 * 4. When a group of details is used reduce the
 *    margin between them so they sit together.
 */

.nhsuk-expander {
  background-color: $color_nhsuk-white;

  .nhsuk-details__summary {
    @include nhsuk-responsive-padding(4);
    background-color: $color_nhsuk-white;
    display: block;

    &:before {
      display: none !important; // sass-lint:disable-line no-important /* [1] */
    }

    &:focus {
      box-shadow: 0 0 0 $nhsuk-box-expander $nhsuk-link-focus-background-color;
    }

    &:hover {
      box-shadow: 0 0 0 $nhsuk-box-expander $nhsuk-link-hover-background-color;
    }

    &:hover,
    &:active,
    &:focus { /* [2] */
      outline: 0;
    }

  }

  .nhsuk-details__summary-text { // Do not use base64. TODO: Refactor this in the future
    background: url(data:image/svg+xml;base64,PHN2ZyBjbGFzcz0ibmhzdWstaWNvbiBuaHN1ay1pY29uX19wbHVzIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAyNCAyNCIgd2lkdGg9IjMycHgiIGFyaWEtaGlkZGVuPSJ0cnVlIj4gIDxkZWZzPiAgICA8c3R5bGU+ICAgICAgLmNscy0ye2ZpbGw6bm9uZTtzdHJva2U6I2ZmZjtzdHJva2UtbGluZWNhcDpyb3VuZDtzdHJva2UtbWl0ZXJsaW1pdDoxMDtzdHJva2Utd2lkdGg6MnB4fSAgICA8L3N0eWxlPiAgPC9kZWZzPiAgPGNpcmNsZSBjeD0iMTIiIGN5PSIxMiIgcj0iMTAiIGZpbGw9IiMwMDU3YWIiLz4gIDxwYXRoIGNsYXNzPSJjbHMtMiIgZD0iTTEyIDh2OE04IDEyaDgiLz48L3N2Zz4=) left -2px center no-repeat;
    color: $color_nhsuk-blue;
    cursor: pointer;
    display: block;
    padding: nhsuk-spacing(2) nhsuk-spacing(2) nhsuk-spacing(2) 38px;
    position: relative;
  }

  .nhsuk-details__text {
    @include nhsuk-responsive-padding(4);
    border-left: 0;
    margin-left: 0;
    margin-top: 0;
  }

}

.nhsuk-expander[open] { // sass-lint:disable-line force-attribute-nesting

  .nhsuk-details__summary {
    border-bottom: 1px solid $color_nhsuk-grey-5;
  }

  .nhsuk-details__summary-text { // Do not use base64. TODO: Refactor this in the future
    background: url(data:image/svg+xml;base64,PHN2ZyBjbGFzcz0ibmhzdWstaWNvbiBuaHN1ay1pY29uX19taW51cyIgZGF0YS1uYW1lPSJMYXllciAxIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAyNCAyNCIgd2lkdGg9IjMycHgiIGFyaWEtaGlkZGVuPSJ0cnVlIj4gIDxjaXJjbGUgY3g9IjEyIiBjeT0iMTIiIHI9IjEwIiBmaWxsPSIjMDA1N2FiIi8+ICA8cGF0aCBmaWxsPSJub25lIiBzdHJva2U9IiNmZmYiIHN0cm9rZS1saW5lY2FwPSJyb3VuZCIgc3Ryb2tlLW1pdGVybGltaXQ9IjEwIiBzdHJva2Utd2lkdGg9IjIiIGQ9Ik04IDEyaDgiLz48L3N2Zz4=) left -2px center no-repeat; /* [3] */
  }

}

.nhsuk-expander-group { /* [4] */

  > .nhsuk-details {
    @include nhsuk-responsive-margin(2, 'bottom');
  }

}
